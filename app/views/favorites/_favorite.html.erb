<% if policy(Favorite.new).create? %>
<div class="favorite">
  <% if favorite = current_user.favorited(post) %>
    Favorited
  <% else %>
    Want to favorite this?
  <% end %>

    <% if favorite = current_user.favorited(post) %>
      <%= link_to [topic, post, favorite], class: 'btn btn-danger', method: :delete do %>
        <i class="glychicon glyphicon-star-empty"> </i>&nbsp; Unfavorite
      <% end %>
    <% else %>
      <%= link_to [topic, post, Favorite.new], class: 'btn btn-primary', method: :post do %>
        <i class="glychicon glyphicon-star"> </i>&nbsp; Favorite
      <% end %>
    <% end %>
</div>
<% end %>